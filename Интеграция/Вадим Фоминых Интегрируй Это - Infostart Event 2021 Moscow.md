**Вадим Фоминых: Интегрируй это**
Infostart Event 2021 Moscow
Конспект к докладу

- платные решения: дорого и не подходит под большинство задач
- Open source это круто
- не пили свой велосипед

Для взаимодействия между система можно использовать специальные open source интеграционные шины:
обмен между системами:
**[n8n.io](https://n8n.io/)** - настраивается связь между приложениями битрикс, телеграмм и т.д.

- бесплатный
- но не для крупных компаний, не стабильный
- low code, не надо практически писать код.
- использует подключаемы Ноды обработки данных, которые могут быть либо платные,
либо open source, где и реализована логика прослойки между решениями
![image](https://user-images.githubusercontent.com/18256848/142643290-ca6d279e-f384-489d-8233-b6e8e4c51ada.png)

**[WSO2](https://wso2.com/)** - шина для взаимодействия систем, состоит из сервера и студии на базе эклипс:

- можно использовать на производительных системах
- быстра
- использует маркет коннкеторов (Kafvk, Github, Jenkins, и т.д)
- можно писать свои коннекторы на JAVA

**Кейс применения:**

- когда не хочется использовать планы обмена
- когда база приемник может быть недоступна
- при этом создается регистр сведений, очередь, где хранятся записи объектов
- лучше не использовать XML, так как громоздкий, лучше JSON
- межсистемное взаимодействие, миграция сотрудника ЗУП в ДО, Active directory
- использовать паттерн обмена "Event sourcing" - каждое событие должно быть отражено в тот же момент во всех заинтересованных приемниках
- испльзовать брокеров сообщений Event streaming (Kafka)
- Использовать шину данных WSO2
- Библиотека [1C Serialization Library](https://github.com/arkuznetsov/SerLib1C) для конвертации объектов и структуры 1С в JSON (Это нужно, чтобы передавать это в шину данных)
- необходимо использовать платформенный механизм "История версии данных":
  - при этом формирование версии не увеличивает блок транзакций
  - информацию необходимо передавать сразу же при формировании новой версии
  - включить можно не снимая конфигурацию с поддержки.
  - содержит различии версий, структура, что выводит, как именно был изменене объект, без лишней информации
  - содержите timestamp и номер версии, что позволяет не хранить очередь, а именно позволяет при ошибке транзакции откатиться именно на конкретную версию
![image](https://user-images.githubusercontent.com/18256848/142694246-954d20fa-2096-4c12-a818-c6e3a9f4e3d6.png)

WSO2 поддерижвает публикацию собственного rest сервиса, и публикацию как OpenApi, например обращаться по документации Swagger
что позволит передавать сообщения напрямую без внешних компонент из 1С и подключиться к elastic search для логирования операций

- в крайнем случае можно сделать доработку как low code
- есть также data mapper, позволяет переводить одну структуру json в другую, типо КД2
- при получении сообщения данные обрабатываются уже обычным кодом 1С.
